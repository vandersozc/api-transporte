package com.vandersoncamp.transporte.service.clientelinha;import com.vandersoncamp.transporte.dto.ClienteLinhaDTO;import com.vandersoncamp.transporte.model.ClienteLinha;import com.vandersoncamp.transporte.model.LinhaLotacao;import com.vandersoncamp.transporte.model.LinhaOnibus;import com.vandersoncamp.transporte.repository.ClienteLinhaRepository;import com.vandersoncamp.transporte.service.linhatransporte.LinhaDtoService;import com.vandersoncamp.transporte.service.linhatransporte.LinhaLotacaoService;import com.vandersoncamp.transporte.service.linhatransporte.LinhaOnibusService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;@Servicepublic class ClienteLinhaService {    @Autowired    private ClienteLinhaRepository repository;    @Autowired    private LinhaDtoService linhaDtoService;    @Autowired    private LinhaOnibusService linhaOnibusService;    @Autowired    private LinhaLotacaoService linhaLotacaoService;    public ClienteLinhaService(ClienteLinhaRepository repository) {        this.repository = repository;    }    public Iterable<ClienteLinha> findAll() {        return repository.findAll();    }    public void save(ClienteLinhaDTO dto) {        saveLinhaOnibus(dto);        saveLinhaLotacao(dto);    }    private void saveLinhaOnibus(ClienteLinhaDTO dto) {        if (dto.getLinhasOnibus() != null) {            for (LinhaOnibus linhaOnibus : dto.getLinhasOnibus()) {                LinhaOnibus linha = linhaOnibusService.geraLinhaOnibus(linhaOnibus);                ClienteLinha clienteLinha = linhaDtoService.toLinhaOnibus(linha, dto.getCliente());                if (!repository.existsByClienteOnibus(dto.getCliente().getId(), linha.getId())) {                    repository.save(clienteLinha);                }            }        }    }    private void saveLinhaLotacao(ClienteLinhaDTO dto) {        if (dto.getLinhasLotacoes() != null) {            for (LinhaLotacao linhaLotacao : dto.getLinhasLotacoes()) {                LinhaLotacao linha = linhaLotacaoService.geraLinhaLotacao(linhaLotacao);                ClienteLinha clienteLinha = linhaDtoService.toLinhaLotacao(linha, dto.getCliente());                if (!repository.existsByClienteLotacao(dto.getCliente().getId(), linha.getId())) {                    repository.save(clienteLinha);                }            }        }    }    public ClienteLinha findById(Long id) {        return repository.findById(id).orElse(null);    }    public void remove(Long id) {        repository.deleteById(id);    }    public Iterable<ClienteLinha> findLinhasByCliente(Long idCliente) {        return repository.findLinhasByCliente(idCliente);    }}